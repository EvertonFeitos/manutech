"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[263],{3913:(T,g,t)=>{t.d(g,{t:()=>d});var d=function(i){return i[i.BAIXA=0]="BAIXA",i[i.MEDIA=1]="MEDIA",i[i.ALTA=2]="ALTA",i[i.URGENTE=3]="URGENTE",i}(d||{})},1230:(T,g,t)=>{t.d(g,{h:()=>d});var d=function(i){return i[i.PENDENTE=0]="PENDENTE",i[i.EM_ANDAMENTO=1]="EM_ANDAMENTO",i[i.DEVOLVIDO=2]="DEVOLVIDO",i[i.CANCELADO=3]="CANCELADO",i[i.VALIDACAO_PENDENTE=4]="VALIDACAO_PENDENTE",i[i.VALIDACAO_CONFIRMADA=5]="VALIDACAO_CONFIRMADA",i}(d||{})},263:(T,g,t)=>{t.r(g),t.d(g,{FormPage:()=>F});var d=t(5861),i=t(6814),c=t(95),_=t(5714),o=t(9843),A=t(7487),u=t(3913),n=t(1230),e=t(9468),l=t(5089),s=t(1475),f=t(5787),b=t(8467);const E=["action"];function v(M,U){if(1&M){const p=e.EpF();e.TgZ(0,"ion-buttons",15)(1,"ion-button",16),e.NdJ("click",function(){e.CHM(p);const a=e.oxw();return e.KtG(a.closeCamera())}),e._uU(2," Fechar "),e.qZA()()}}function C(M,U){1&M&&(e.TgZ(0,"p",17),e._uU(1,"\u231b Carregando..."),e.qZA())}function y(M,U){if(1&M){const p=e.EpF();e.ynx(0),e.TgZ(1,"p"),e._uU(2,"Para iniciar um chamado, clique no bot\xe3o da camera."),e.qZA(),e.TgZ(3,"ion-button",18),e.NdJ("click",function(){e.CHM(p);const a=e.oxw(),m=e.MAs(10);return e.KtG(a.handle(m,"start"))}),e._UZ(4,"ion-icon",19),e.qZA(),e.TgZ(5,"ion-row")(6,"ion-col",20)(7,"p"),e._uU(8,"Ou busque pelo c\xf3digo do imobilizado:"),e.qZA(),e.TgZ(9,"ion-input",21),e.NdJ("ngModelChange",function(a){e.CHM(p);const m=e.oxw();return e.KtG(m.buscarCodImobilizado=a)}),e.qZA()()(),e.TgZ(10,"ion-button",22),e.NdJ("click",function(){e.CHM(p);const a=e.oxw();return e.KtG(a.buscarPorCodigo())}),e._uU(11,"Buscar "),e._UZ(12,"ion-icon",23),e.qZA(),e.BQk()}if(2&M){const p=e.oxw();e.xp6(9),e.Q6J("inputMode","number")("ngModel",p.buscarCodImobilizado),e.xp6(1),e.Q6J("disabled",!p.buscarCodImobilizado)}}const S=function(){return["/home"]};function x(M,U){if(1&M){const p=e.EpF();e.ynx(0),e.TgZ(1,"form",24)(2,"h2"),e._uU(3),e.qZA(),e.TgZ(4,"ion-item-divider"),e._uU(5,"Setor"),e.qZA(),e.TgZ(6,"ion-item",25),e._UZ(7,"ion-input",26),e.qZA(),e.TgZ(8,"ion-radio-group",27)(9,"ion-list",28)(10,"ion-item-divider"),e._uU(11,"Prioridade"),e.qZA(),e.TgZ(12,"ion-item",25)(13,"ion-radio",29),e._uU(14,"Prioridade baixa"),e.qZA()(),e.TgZ(15,"ion-item",25)(16,"ion-radio",29),e._uU(17,"Prioridade m\xe9dia"),e.qZA()(),e.TgZ(18,"ion-item",25)(19,"ion-radio",29),e._uU(20,"Prioridade alta"),e.qZA()(),e.TgZ(21,"ion-item",25)(22,"ion-radio",29),e._uU(23,"Urgente"),e.qZA()()()(),e.TgZ(24,"ion-item-divider"),e._uU(25,"Detalhamento"),e.qZA(),e.TgZ(26,"ion-item",25),e._UZ(27,"ion-textarea",30),e.qZA(),e.TgZ(28,"ion-grid")(29,"ion-row")(30,"ion-col",31)(31,"ion-button",32),e._uU(32,"Descartar "),e._UZ(33,"ion-icon",33),e.qZA()(),e.TgZ(34,"ion-col",31)(35,"ion-button",34),e.NdJ("click",function(){e.CHM(p);const a=e.oxw();return e.KtG(a.confirm())}),e._uU(36,"Confirma "),e._UZ(37,"ion-icon",23),e.qZA()()()()(),e.BQk()}if(2&M){const p=e.oxw();e.xp6(1),e.Q6J("formGroup",p.novaManutencaoForm),e.xp6(2),e.Oqu(p.nomeImobilizado),e.xp6(4),e.Q6J("value",p.setorNome),e.xp6(6),e.Q6J("value",p.PrioridadeChamado.BAIXA),e.xp6(3),e.Q6J("value",p.PrioridadeChamado.MEDIA),e.xp6(3),e.Q6J("value",p.PrioridadeChamado.ALTA),e.xp6(3),e.Q6J("value",p.PrioridadeChamado.URGENTE),e.xp6(5),e.Q6J("rows",5),e.xp6(4),e.Q6J("routerLink",e.DdM(9,S))}}function B(M,U){1&M&&(e.TgZ(0,"ion-footer")(1,"ion-toolbar")(2,"ion-buttons",35),e._UZ(3,"ion-back-button",36),e.qZA()()())}let F=(()=>{var M;class U{constructor(r,a,m,I,O,h,P,D,L){this.chamados=r,this.navCtrl=a,this.tokenSrv=m,this.alertSrv=I,this.formBuilder=O,this.getImobilizado=h,this.manutencaoSrv=P,this.router=D,this.loaddingCtrl=L,this.config={constraints:{}},this.readQrcode=!1,this.typeCode=!1,this.PrioridadeChamado=u.t,this.scannerTrue=!1,this.novaManutencaoForm=this.formBuilder.group({prioridade:[u.t.BAIXA],detalhamento:[null,c.kI.required]})}ngOnInit(){}ngAfterViewInit(){}scanEvent(r,a){return 64===r[0].type&&(this.scannerTrue=!0,this.action.pause(),setTimeout(()=>(this.scannerTrue=!1,this.action.stop(),this.scanResult(r[0].value)),1e3)),!1}clickButtonTypeCod(){this.typeCode=!0}handle(r,a){return(0,d.Z)(function*(){const m=h=>{"NotFoundError"===h.name&&(console.error("Erro: C\xe2mera n\xe3o encontrada. Verifique as permiss\xf5es do aplicativo"),alert("C\xe2mera n\xe3o encontrada. Verifique as permiss\xf5es do aplicativo"))};"start"===a?r[a](h=>{const P=h.find(D=>/back|rear|environment/gi.test(D.label));/iPad|iPhone|iPod/.test(navigator.userAgent)?r.playDevice(h[1]?h[1].deviceId:h[0].deviceId):r.playDevice(P?P.deviceId:h[0].deviceId)}).subscribe(h=>{console.log(a,h)},m):r[a]().subscribe(h=>console.log(a,h),m)})()}toggleCamera(){var r=this;return(0,d.Z)(function*(){const a=r.action,I=r.action.devices.value,O=I[r.action.deviceIndexActive];if(O&&I.length>1){const h=I.find(P=>P.deviceId!==O.deviceId);if(h){const P=yield r.loaddingCtrl.create({message:"Trocando de c\xe2mera..."});yield P.present();try{a.stop();const D=()=>{a.playDevice(h.deviceId)};a.start(D).subscribe(),yield P.dismiss()}catch(D){console.error(D),yield P.dismiss(),yield(yield r.alertSrv.create({header:"Erro!",message:D.message?null==D?void 0:D.message:"Erro desconhecido, tente novamente",buttons:["Ok"]})).present()}}}})()}scanResult(r){var a=this;return(0,d.Z)(function*(){const m=JSON.parse(r);a.imobilizadoId=Number(m.elemento.ATexto1);const I=yield a.getImobilizado.get(a.imobilizadoId);var O,h,P;I?(a.readQrcode=!0,a.setorId=null===(O=I.setor)||void 0===O?void 0:O.id,a.setorNome=null===(h=I.setor)||void 0===h?void 0:h.name,a.nomeImobilizado=null!==(P=I.descricao)&&void 0!==P?P:m.elemento.ATexto2):a.readQrcode=!1})()}closeCamera(){this.handle(this.action,"stop"),this.router.navigate(["/home"])}confirm(){var r=this;return(0,d.Z)(function*(){r.novaManutencaoForm.valid?r.manutencaoSrv.saveChamado(r.mapFormToNewChamado(r.novaManutencaoForm.value)).subscribe(()=>{r.navCtrl.navigateBack("/home")}):yield(yield r.alertSrv.create({header:"Erro!",message:"Alguns campos do chamado n\xe3o est\xe3o preenchidos. Preencha todos os campos e tente novamente.",buttons:["Ok"]})).present()})()}buscarPorCodigo(){var r=this;return(0,d.Z)(function*(){yield r.scanResult(`{"elemento":{"ATexto1":${r.buscarCodImobilizado},"ATexto2":"","ATexto3":""}}`)})()}mapFormToNewChamado(r){return{detalhamento:r.detalhamento,funcionario:{id:this.tokenSrv.funcionarioId},imobilizado:{id:this.imobilizadoId},prioridade:r.prioridade,setor:{id:this.setorId},status:n.h.PENDENTE}}}return(M=U).\u0275fac=function(r){return new(r||M)(e.Y36(l.I),e.Y36(o.SH),e.Y36(s.B),e.Y36(o.Br),e.Y36(c.qu),e.Y36(f.U),e.Y36(b.H),e.Y36(_.F0),e.Y36(o.HT))},M.\u0275cmp=e.Xpm({type:M,selectors:[["app-form"]],viewQuery:function(r,a){if(1&r&&e.Gf(E,5),2&r){let m;e.iGM(m=e.CRH())&&(a.action=m.first)}},standalone:!0,features:[e.jDz],decls:23,vars:12,consts:[[3,"translucent"],["slot","end",4,"ngIf"],[3,"fullscreen"],[3,"hidden"],[1,"scanner",3,"src"],[1,"scan"],[1,"box-shadow",3,"config","event"],["action","scanner"],[1,"changing-camera"],["shape","round","size","large",3,"click"],["slot","icon-only","name","sync"],["class","ion-text-center",4,"ngIf"],[1,"ion-justify-content-center"],["size-md","6","size-lg","4","size-xl","3"],[4,"ngIf"],["slot","end"],[3,"click"],[1,"ion-text-center"],["size","large","color","light",1,"full-btn",3,"click"],["slot","icon-only","size","large","name","camera"],["size","12"],["fill","outline",3,"inputMode","ngModel","ngModelChange"],["expand","block","fill","solid","color","primary",3,"disabled","click"],["slot","start","name","checkmark"],[3,"formGroup"],["lines","full","fill","outline"],["readonly","",3,"value"],["formControlName","prioridade"],["lines","none"],[3,"value"],["formControlName","detalhamento",3,"rows"],["size","6"],["expand","block","fill","outline","color","danger",3,"routerLink"],["slot","start","name","close"],["expand","block","fill","solid","color","primary",3,"click"],["slot","start"],["color","primary","defaultHref","/home","text","Sair"]],template:function(r,a){if(1&r){const m=e.EpF();e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Abrir chamado"),e.qZA(),e.YNc(4,v,3,0,"ion-buttons",1),e.qZA()(),e.TgZ(5,"ion-content",2)(6,"div",3),e._UZ(7,"img",4),e.TgZ(8,"div",5)(9,"ngx-scanner-qrcode",6,7),e.NdJ("event",function(O){e.CHM(m);const h=e.MAs(10);return e.KtG(a.scanEvent(O,h))}),e.qZA(),e.TgZ(11,"div",8)(12,"ion-button",9),e.NdJ("click",function(){return a.toggleCamera()}),e._UZ(13,"ion-icon",10),e.qZA()()()(),e.YNc(14,C,2,0,"p",11),e.TgZ(15,"div",3)(16,"ion-grid")(17,"ion-row",12)(18,"ion-col",13),e.YNc(19,y,13,3,"ng-container",14),e.YNc(20,x,38,10,"ng-container",14),e.qZA()()()()(),e._uU(21),e.YNc(22,B,4,0,"ion-footer",14)}if(2&r){const m=e.MAs(10);e.Q6J("translucent",!0),e.xp6(4),e.Q6J("ngIf",m.isStart),e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("hidden",!m.isStart),e.xp6(1),e.Q6J("src",a.scannerTrue?"assets/img/scanner-true.png":"assets/img/scanner.png",e.LSH),e.xp6(2),e.Q6J("config",a.config),e.xp6(5),e.Q6J("ngIf",m.isLoading),e.xp6(1),e.Q6J("hidden",m.isStart||m.isLoading),e.xp6(4),e.Q6J("ngIf",!a.readQrcode),e.xp6(1),e.Q6J("ngIf",a.readQrcode),e.xp6(1),e.hij("\n",m," "),e.xp6(1),e.Q6J("ngIf",!m.isStart)}},dependencies:[o.Pc,o.oU,o.YG,o.Sm,o.wI,o.W2,o.fr,o.jY,o.Gu,o.gu,o.pK,o.Ie,o.rH,o.q_,o.B7,o.se,o.Nd,o.g2,o.wd,o.sr,o.U5,o.QI,o.j9,o.cs,o.YI,i.ez,i.O5,c.u5,c._Y,c.JJ,c.JL,c.On,_.Bz,_.rH,A.Mk,A.d$,c.UX,c.sg,c.u],styles:["[_nghost-%COMP%]   .full-btn[_ngcontent-%COMP%]{width:100%;height:220px}[_nghost-%COMP%]   .full-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:72px;height:72px}[_nghost-%COMP%]   ion-radio-group[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   ion-input[_ngcontent-%COMP%]{min-height:42px;--padding-end: 8px;--padding-start: 8px;border:1px solid #4e5c5c;border-radius:10px}[_nghost-%COMP%]   .scanner[_ngcontent-%COMP%]{opacity:.8;height:300px;width:381px;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1}[_nghost-%COMP%]   .box-shadow[_ngcontent-%COMP%]{height:215px;width:300px;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);border-radius:36px}[_nghost-%COMP%]   .changing-camera[_ngcontent-%COMP%]{position:fixed;bottom:0;padding-bottom:10px;left:15%;transform:translate(-50%,-50%)}[_nghost-%COMP%]     ngx-scanner-qrcode .origin-video{border-radius:36px!important;top:50%;left:50%;transform:translate(-50%,-50%);position:absolute}"]}),U})()},5089:(T,g,t)=>{t.d(g,{I:()=>l});var d=t(8180),i=t(4664),c=t(2096),_=t(3913),o=t(1230),A=t(9468),u=t(8305),n=t(8409);let l=(()=>{var s;class f{constructor(E,v){this.setorSrv=E,this.funcionarioSrv=v,this.statusChamado=[{name:"VALIDACAO PENDENTE",value:o.h.VALIDACAO_PENDENTE,color:"tertiary"},{name:"Pendente",value:o.h.PENDENTE,color:"warning"},{name:"Em andamento",value:o.h.EM_ANDAMENTO,color:"primary"},{name:"Devolvido",value:o.h.DEVOLVIDO,color:"danger"},{name:"Cancelado",value:o.h.CANCELADO,color:"danger"},{name:"VALIDA\xc7\xc3O CONFIRMADA",value:o.h.VALIDACAO_CONFIRMADA,color:"success"}],this.prioridadeChamado=[{name:"Baixa",value:_.t.BAIXA},{name:"M\xe9dia",value:_.t.MEDIA},{name:"Alta",value:_.t.ALTA},{name:"Urgente",value:_.t.URGENTE}]}getPrioridadeNome(E){const v=this.prioridadeChamado.find(C=>C.value===E);return null==v?void 0:v.name}getStatusCor(E){const v=this.statusChamado.find(C=>C.value===E);return null==v?void 0:v.color}getStatusNome(E){const v=this.statusChamado.find(C=>C.value===E);return null==v?void 0:v.name}getSetorNome(E){return this.setorSrv.getById(E).pipe((0,d.q)(1),(0,i.w)(v=>(0,c.of)(v.name)))}getFuncionarioNome(E){return this.funcionarioSrv.getById(E).pipe((0,d.q)(1),(0,i.w)(v=>(0,c.of)(v&&v.name?v.name:null)))}}return(s=f).\u0275fac=function(E){return new(E||s)(A.LFG(u.G),A.LFG(n.e))},s.\u0275prov=A.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),f})()},3959:(T,g,t)=>{t.d(g,{_:()=>A});var d=t(5861),i=t(5619),c=t(9468),_=t(9862),o=t(5178);let A=(()=>{var u;class n{constructor(l,s){this.http=l,this.ionSorageSrv=s,this.baseUrl=new i.X(" "),this.init()}init(){var l=this;return(0,d.Z)(function*(){const s=(yield l.getBaseUrlFromStorage())||"http://179.190.96.46:160";l.setBaseUrl(s)})()}getBaseUrlFromStorage(){var l=this;return(0,d.Z)(function*(){return yield l.ionSorageSrv.get("baseUrl")})()}get baseUrl$(){return this.baseUrl.asObservable()}setBaseUrl(l){this.baseUrl.next(l),this.ionSorageSrv.set("baseUrl",l)}get(l,s){const f=`${this.baseUrl.value}/${l}`;return s?this.http.get(f,{params:s}):this.http.get(f)}post(l,s){return this.http.post(`${this.baseUrl.value}/${l}`,s)}put(l,s){return this.http.put(`${this.baseUrl.value}/${l}`,s)}delete(l){return this.http.delete(`${this.baseUrl.value}/${l}`)}}return(u=n).\u0275fac=function(l){return new(l||u)(c.LFG(_.eN),c.LFG(o.m))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),n})()},8409:(T,g,t)=>{t.d(g,{e:()=>c});var d=t(9468),i=t(3959);let c=(()=>{var _;class o{constructor(u){this.baseApiService=u,this.apiUrl="api/Funcionario"}getById(u){return this.baseApiService.get(`${this.apiUrl}/Get/${u}`)}getAllChamados(){return this.baseApiService.get(`${this.apiUrl}/GetAllChamados`)}getAllManutencao(){return this.baseApiService.get(`${this.apiUrl}/GetAllManutencao`)}}return(_=o).\u0275fac=function(u){return new(u||_)(d.LFG(i._))},_.\u0275prov=d.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),o})()},5787:(T,g,t)=>{t.d(g,{U:()=>u});var d=t(5861),i=t(708),c=t(9468),_=t(9843),o=t(3959);let A=(()=>{var n;class e{constructor(s){this.baseApiService=s,this.apiUrl="api/Imobilizado"}getById(s){return this.baseApiService.get(`${this.apiUrl}/GetById/${s}`)}}return(n=e).\u0275fac=function(s){return new(s||n)(c.LFG(o._))},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),u=(()=>{var n;class e{constructor(s,f,b){this.loaddingCtrl=s,this.alertSrv=f,this.imobilizadoSrv=b}get(s){var f=this;return(0,d.Z)(function*(){var b;const E=yield f.loaddingCtrl.create({message:"Aguarde..."});yield E.present();const v=function(S){return(b=b||(0,d.Z)(function*(x){yield E.dismiss(),yield(yield f.alertSrv.create({header:"Erro!",message:x||"Erro desconhecido, tente novamente",buttons:["Ok"]})).present()})).apply(this,arguments)};if(!s)return yield E.dismiss(),null;const C=yield(0,i.n)(f.imobilizadoSrv.getById(s));try{return C&&C.setor?(yield E.dismiss(),C):(v("Imobilizado n\xe3o encontrado"),null)}catch{return v("Erro ao tentar localizar imobilizado, tente novamente"),null}})()}}return(n=e).\u0275fac=function(s){return new(s||n)(c.LFG(_.HT),c.LFG(_.Br),c.LFG(A))},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),e})()},8467:(T,g,t)=>{t.d(g,{H:()=>_});var d=t(9862),i=t(9468),c=t(3959);let _=(()=>{var o;class A{constructor(n){this.baseApiService=n,this.patchApi="api/Manutencao"}saveChamado(n){return this.baseApiService.post(`${this.patchApi}/SaveChamado`,n)}saveManutencao(n){return this.baseApiService.post(`${this.patchApi}/SaveManutencao`,n)}getAll(n){let e=new d.LE;if(n&&Object.keys(n)){for(const l in n)n.hasOwnProperty(l)&&(e=e.set(l,n[l]));return this.baseApiService.get(`${this.patchApi}/GetAll`,e)}return this.baseApiService.get(`${this.patchApi}/GetAll`)}cancelamentoChamado(n,e){return this.baseApiService.post(`${this.patchApi}/CancelamentoChamado?id=${n}&obs=${e}`,{})}finalizarManutencao(n){return this.baseApiService.post(`${this.patchApi}/FinalizarManutencao?id=${n}`,{})}finalizarChamado(n){return this.baseApiService.post(`${this.patchApi}/FinalizarChamado?id=${n.id}&funcionarioId=${n.funcionarioId}&setorId=${n.setorId}&obs=${n.obs}`,{})}get(n){return this.baseApiService.get(`${this.patchApi}/Get?id=${n}`)}getAllValidacao(n){return this.baseApiService.get(`${this.patchApi}/GetAllValidacao?mecanicoCod=${n}`)}}return(o=A).\u0275fac=function(n){return new(n||o)(i.LFG(c._))},o.\u0275prov=i.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),A})()},8305:(T,g,t)=>{t.d(g,{G:()=>c});var d=t(9468),i=t(3959);let c=(()=>{var _;class o{constructor(u){this.baseApiService=u,this.apiUrl="api/Setor"}getById(u){return this.baseApiService.get(`${this.apiUrl}/Get/${u}`)}getAllManutecao(){return this.baseApiService.get(`${this.apiUrl}/GetAllManutecao`)}}return(_=o).\u0275fac=function(u){return new(u||_)(d.LFG(i._))},_.\u0275prov=d.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),o})()},708:(T,g,t)=>{t.d(g,{n:()=>i});var d=t(6973);function i(c,_){const o="object"==typeof _;return new Promise((A,u)=>{let e,n=!1;c.subscribe({next:l=>{e=l,n=!0},error:u,complete:()=>{n?A(e):o?A(_.defaultValue):u(new d.K)}})})}}}]);