"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[263],{3913:(D,g,n)=>{n.d(g,{t:()=>l});var l=function(r){return r[r.BAIXA=0]="BAIXA",r[r.MEDIA=1]="MEDIA",r[r.ALTA=2]="ALTA",r[r.URGENTE=3]="URGENTE",r}(l||{})},1230:(D,g,n)=>{n.d(g,{h:()=>l});var l=function(r){return r[r.PENDENTE=0]="PENDENTE",r[r.EM_ANDAMENTO=1]="EM_ANDAMENTO",r[r.DEVOLVIDO=2]="DEVOLVIDO",r[r.CANCELADO=3]="CANCELADO",r[r.VALIDACAO_PENDENTE=4]="VALIDACAO_PENDENTE",r[r.VALIDACAO_CONFIRMADA=5]="VALIDACAO_CONFIRMADA",r}(l||{})},263:(D,g,n)=>{n.r(g),n.d(g,{FormPage:()=>F});var l=n(5861),r=n(6814),c=n(95),s=n(5714),o=n(9843),v=n(7487),_=n(3913),t=n(1230),e=n(9468),h=n(5089),p=n(1475),O=n(5787),b=n(8467);const A=["action"];function u(E,U){if(1&E){const m=e.EpF();e.TgZ(0,"ion-buttons",15)(1,"ion-button",16),e.NdJ("click",function(){e.CHM(m);const a=e.oxw();return e.KtG(a.closeCamera())}),e._uU(2," Fechar "),e.qZA()()}}function P(E,U){1&E&&(e.TgZ(0,"p",17),e._uU(1,"\u231b Carregando..."),e.qZA())}function y(E,U){if(1&E){const m=e.EpF();e.ynx(0),e.TgZ(1,"p"),e._uU(2,"Para iniciar um chamado, clique no bot\xe3o da camera."),e.qZA(),e.TgZ(3,"ion-button",18),e.NdJ("click",function(){e.CHM(m);const a=e.oxw(),d=e.MAs(10);return e.KtG(a.handle(d,"start"))}),e._UZ(4,"ion-icon",19),e.qZA(),e.TgZ(5,"ion-row")(6,"ion-col",20)(7,"p"),e._uU(8,"Ou busque pelo c\xf3digo do imobilizado:"),e.qZA(),e.TgZ(9,"ion-input",21),e.NdJ("ngModelChange",function(a){e.CHM(m);const d=e.oxw();return e.KtG(d.buscarCodImobilizado=a)}),e.qZA()()(),e.TgZ(10,"ion-button",22),e.NdJ("click",function(){e.CHM(m);const a=e.oxw();return e.KtG(a.buscarPorCodigo())}),e._uU(11,"Buscar "),e._UZ(12,"ion-icon",23),e.qZA(),e.BQk()}if(2&E){const m=e.oxw();e.xp6(9),e.Q6J("inputMode","number")("ngModel",m.buscarCodImobilizado),e.xp6(1),e.Q6J("disabled",!m.buscarCodImobilizado)}}const L=function(){return["/home"]};function x(E,U){if(1&E){const m=e.EpF();e.ynx(0),e.TgZ(1,"form",24)(2,"h2"),e._uU(3),e.qZA(),e.TgZ(4,"ion-item-divider"),e._uU(5,"Setor"),e.qZA(),e.TgZ(6,"ion-item",25),e._UZ(7,"ion-input",26),e.qZA(),e.TgZ(8,"ion-radio-group",27)(9,"ion-list",28)(10,"ion-item-divider"),e._uU(11,"Prioridade"),e.qZA(),e.TgZ(12,"ion-item",25)(13,"ion-radio",29),e._uU(14,"Prioridade Baixa"),e.qZA()(),e.TgZ(15,"ion-item",25)(16,"ion-radio",29),e._uU(17,"Prioridade m\xe9dia"),e.qZA()(),e.TgZ(18,"ion-item",25)(19,"ion-radio",29),e._uU(20,"Prioridade alta"),e.qZA()(),e.TgZ(21,"ion-item",25)(22,"ion-radio",29),e._uU(23,"Urgente"),e.qZA()()()(),e.TgZ(24,"ion-item-divider"),e._uU(25,"Detalhamento"),e.qZA(),e.TgZ(26,"ion-item",25),e._UZ(27,"ion-textarea",30),e.qZA(),e.TgZ(28,"ion-grid")(29,"ion-row")(30,"ion-col",31)(31,"ion-button",32),e._uU(32,"Descartar "),e._UZ(33,"ion-icon",33),e.qZA()(),e.TgZ(34,"ion-col",31)(35,"ion-button",34),e.NdJ("click",function(){e.CHM(m);const a=e.oxw();return e.KtG(a.confirm())}),e._uU(36,"Confirma "),e._UZ(37,"ion-icon",23),e.qZA()()()()(),e.BQk()}if(2&E){const m=e.oxw();e.xp6(1),e.Q6J("formGroup",m.novaManutencaoForm),e.xp6(2),e.Oqu(m.nomeImobilizado),e.xp6(4),e.Q6J("value",m.setorNome),e.xp6(6),e.Q6J("value",m.PrioridadeChamado.BAIXA),e.xp6(3),e.Q6J("value",m.PrioridadeChamado.MEDIA),e.xp6(3),e.Q6J("value",m.PrioridadeChamado.ALTA),e.xp6(3),e.Q6J("value",m.PrioridadeChamado.URGENTE),e.xp6(5),e.Q6J("rows",5),e.xp6(4),e.Q6J("routerLink",e.DdM(9,L))}}function B(E,U){1&E&&(e.TgZ(0,"ion-footer")(1,"ion-toolbar")(2,"ion-buttons",35),e._UZ(3,"ion-back-button",36),e.qZA()()())}let F=(()=>{var E;class U{constructor(i,a,d,f,I,M,C,T,S){this.chamados=i,this.navCtrl=a,this.tokenSrv=d,this.alertSrv=f,this.formBuilder=I,this.getImobilizado=M,this.manutencaoSrv=C,this.router=T,this.loaddingCtrl=S,this.config={constraints:{}},this.readQrcode=!1,this.typeCode=!1,this.PrioridadeChamado=_.t,this.scannerTrue=!1,this.novaManutencaoForm=this.formBuilder.group({prioridade:[_.t.BAIXA],detalhamento:[null,c.kI.required]})}ngOnInit(){}ngAfterViewInit(){}scanEvent(i,a){return 64===i[0].type&&(this.scannerTrue=!0,this.action.pause(),setTimeout(()=>(this.scannerTrue=!1,this.action.stop(),this.scanResult(i[0].value)),1e3)),!1}clickButtonTypeCod(){this.typeCode=!0}handle(i,a){return(0,l.Z)(function*(){console.log(i),"start"===a?i[a](f=>{const I=f.find(M=>/back|rear|environment/gi.test(M.label));i.playDevice(I?I.deviceId:f[0].deviceId)}).subscribe(f=>{console.log(a,f)},alert):i[a]().subscribe(f=>console.log(a,f),alert)})()}toggleCamera(){var i=this;return(0,l.Z)(function*(){const a=i.action,f=i.action.devices.value,I=f[i.action.deviceIndexActive];if(I&&f.length>1){const M=f.find(C=>C.deviceId!==I.deviceId);if(M){const C=yield i.loaddingCtrl.create({message:"Trocando de c\xe2mera..."});yield C.present();try{a.stop();const T=()=>{a.playDevice(M.deviceId)};a.start(T).subscribe()}catch(T){console.error(T),yield C.dismiss(),yield(yield i.alertSrv.create({header:"Erro!",message:T.message?null==T?void 0:T.message:"Erro desconhecido, tente novamente",buttons:["Ok"]})).present()}}}})()}scanResult(i){var a=this;return(0,l.Z)(function*(){const d=JSON.parse(i);a.imobilizadoId=Number(d.elemento.ATexto1);const f=yield a.getImobilizado.get(a.imobilizadoId);var I,M,C;f?(a.readQrcode=!0,a.setorId=null===(I=f.setor)||void 0===I?void 0:I.id,a.setorNome=null===(M=f.setor)||void 0===M?void 0:M.name,a.nomeImobilizado=null!==(C=f.descricao)&&void 0!==C?C:d.elemento.ATexto2):a.readQrcode=!1})()}closeCamera(){this.handle(this.action,"stop"),this.router.navigate(["/home"])}confirm(){var i=this;return(0,l.Z)(function*(){i.novaManutencaoForm.valid?i.manutencaoSrv.saveChamado(i.mapFormToNewChamado(i.novaManutencaoForm.value)).subscribe(()=>{i.navCtrl.navigateBack("/home")}):yield(yield i.alertSrv.create({header:"Erro!",message:"Alguns campos do chamado n\xe3o est\xe3o preenchidos. Preencha todos os campos e tente novamente.",buttons:["Ok"]})).present()})()}buscarPorCodigo(){var i=this;return(0,l.Z)(function*(){yield i.scanResult(`{"elemento":{"ATexto1":${i.buscarCodImobilizado},"ATexto2":"","ATexto3":""}}`)})()}mapFormToNewChamado(i){return{detalhamento:i.detalhamento,funcionario:{id:this.tokenSrv.funcionarioId},imobilizado:{id:this.imobilizadoId},prioridade:i.prioridade,setor:{id:this.setorId},status:t.h.PENDENTE}}}return(E=U).\u0275fac=function(i){return new(i||E)(e.Y36(h.I),e.Y36(o.SH),e.Y36(p.B),e.Y36(o.Br),e.Y36(c.qu),e.Y36(O.U),e.Y36(b.H),e.Y36(s.F0),e.Y36(o.HT))},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-form"]],viewQuery:function(i,a){if(1&i&&e.Gf(A,5),2&i){let d;e.iGM(d=e.CRH())&&(a.action=d.first)}},standalone:!0,features:[e.jDz],decls:23,vars:12,consts:[[3,"translucent"],["slot","end",4,"ngIf"],[3,"fullscreen"],[3,"hidden"],[1,"scanner",3,"src"],[1,"scan"],[1,"box-shadow",3,"config","event"],["action","scanner"],[1,"changing-camera"],["shape","round","size","large",3,"click"],["slot","icon-only","name","sync"],["class","ion-text-center",4,"ngIf"],[1,"ion-justify-content-center"],["size-md","6","size-lg","4","size-xl","3"],[4,"ngIf"],["slot","end"],[3,"click"],[1,"ion-text-center"],["size","large","color","light",1,"full-btn",3,"click"],["slot","icon-only","size","large","name","camera"],["size","12"],["fill","outline",3,"inputMode","ngModel","ngModelChange"],["expand","block","fill","solid","color","primary",3,"disabled","click"],["slot","start","name","checkmark"],[3,"formGroup"],["lines","full","fill","outline"],["readonly","",3,"value"],["formControlName","prioridade"],["lines","none"],[3,"value"],["formControlName","detalhamento",3,"rows"],["size","6"],["expand","block","fill","outline","color","danger",3,"routerLink"],["slot","start","name","close"],["expand","block","fill","solid","color","primary",3,"click"],["slot","start"],["color","primary","defaultHref","/home","text","Sair"]],template:function(i,a){if(1&i){const d=e.EpF();e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Abrir chamado"),e.qZA(),e.YNc(4,u,3,0,"ion-buttons",1),e.qZA()(),e.TgZ(5,"ion-content",2)(6,"div",3),e._UZ(7,"img",4),e.TgZ(8,"div",5)(9,"ngx-scanner-qrcode",6,7),e.NdJ("event",function(I){e.CHM(d);const M=e.MAs(10);return e.KtG(a.scanEvent(I,M))}),e.qZA(),e.TgZ(11,"div",8)(12,"ion-button",9),e.NdJ("click",function(){return a.toggleCamera()}),e._UZ(13,"ion-icon",10),e.qZA()()()(),e.YNc(14,P,2,0,"p",11),e.TgZ(15,"div",3)(16,"ion-grid")(17,"ion-row",12)(18,"ion-col",13),e.YNc(19,y,13,3,"ng-container",14),e.YNc(20,x,38,10,"ng-container",14),e.qZA()()()()(),e._uU(21),e.YNc(22,B,4,0,"ion-footer",14)}if(2&i){const d=e.MAs(10);e.Q6J("translucent",!0),e.xp6(4),e.Q6J("ngIf",d.isStart),e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("hidden",!d.isStart),e.xp6(1),e.Q6J("src",a.scannerTrue?"assets/img/scanner-true.png":"assets/img/scanner.png",e.LSH),e.xp6(2),e.Q6J("config",a.config),e.xp6(5),e.Q6J("ngIf",d.isLoading),e.xp6(1),e.Q6J("hidden",d.isStart||d.isLoading),e.xp6(4),e.Q6J("ngIf",!a.readQrcode),e.xp6(1),e.Q6J("ngIf",a.readQrcode),e.xp6(1),e.hij("\n",d," "),e.xp6(1),e.Q6J("ngIf",!d.isStart)}},dependencies:[o.Pc,o.oU,o.YG,o.Sm,o.wI,o.W2,o.fr,o.jY,o.Gu,o.gu,o.pK,o.Ie,o.rH,o.q_,o.B7,o.se,o.Nd,o.g2,o.wd,o.sr,o.U5,o.QI,o.j9,o.cs,o.YI,r.ez,r.O5,c.u5,c._Y,c.JJ,c.JL,c.On,s.Bz,s.rH,v.Mk,v.d$,c.UX,c.sg,c.u],styles:["[_nghost-%COMP%]   .full-btn[_ngcontent-%COMP%]{width:100%;height:220px}[_nghost-%COMP%]   .full-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:72px;height:72px}[_nghost-%COMP%]   ion-radio-group[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   ion-input[_ngcontent-%COMP%]{min-height:42px;--padding-end: 8px;--padding-start: 8px;border:1px solid #4e5c5c;border-radius:10px}[_nghost-%COMP%]   .scanner[_ngcontent-%COMP%]{opacity:.8;height:300px;width:381px;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1}[_nghost-%COMP%]   .box-shadow[_ngcontent-%COMP%]{height:215px;width:300px;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);border-radius:36px}[_nghost-%COMP%]   .changing-camera[_ngcontent-%COMP%]{position:fixed;bottom:0;padding-bottom:10px;left:15%;transform:translate(-50%,-50%)}[_nghost-%COMP%]     ngx-scanner-qrcode .origin-video{border-radius:36px!important;top:50%;left:50%;transform:translate(-50%,-50%);position:absolute}"]}),U})()},5089:(D,g,n)=>{n.d(g,{I:()=>h});var l=n(8180),r=n(4664),c=n(2096),s=n(3913),o=n(1230),v=n(9468),_=n(8305),t=n(8409);let h=(()=>{var p;class O{constructor(A,u){this.setorSrv=A,this.funcionarioSrv=u,this.statusChamado=[{name:"VALIDACAO PENDENTE",value:o.h.VALIDACAO_PENDENTE,color:"tertiary"},{name:"Pendente",value:o.h.PENDENTE,color:"warning"},{name:"Em andamento",value:o.h.EM_ANDAMENTO,color:"primary"},{name:"Devolvido",value:o.h.DEVOLVIDO,color:"danger"},{name:"Cancelado",value:o.h.CANCELADO,color:"danger"},{name:"VALIDA\xc7\xc3O CONFIRMADA",value:o.h.VALIDACAO_CONFIRMADA,color:"success"}],this.prioridadeChamado=[{name:"Baixa",value:s.t.BAIXA},{name:"M\xe9dia",value:s.t.MEDIA},{name:"Alta",value:s.t.ALTA},{name:"Urgente",value:s.t.URGENTE}]}getPrioridadeNome(A){const u=this.prioridadeChamado.find(P=>P.value===A);return null==u?void 0:u.name}getStatusCor(A){const u=this.statusChamado.find(P=>P.value===A);return null==u?void 0:u.color}getStatusNome(A){const u=this.statusChamado.find(P=>P.value===A);return null==u?void 0:u.name}getSetorNome(A){return this.setorSrv.getById(A).pipe((0,l.q)(1),(0,r.w)(u=>(0,c.of)(u.name)))}getFuncionarioNome(A){return this.funcionarioSrv.getById(A).pipe((0,l.q)(1),(0,r.w)(u=>(0,c.of)(u.name)))}}return(p=O).\u0275fac=function(A){return new(A||p)(v.LFG(_.G),v.LFG(t.e))},p.\u0275prov=v.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),O})()},3959:(D,g,n)=>{n.d(g,{_:()=>s});var l=n(5619),r=n(9468),c=n(9862);let s=(()=>{var o;class v{constructor(t){this.http=t,this.baseUrl=new l.X(this.getBaseUrlFromLocalStorage()||"http://179.190.96.46:160")}getBaseUrlFromLocalStorage(){return localStorage.getItem("baseUrl")}get baseUrl$(){return this.baseUrl.asObservable()}setBaseUrl(t){this.baseUrl.next(t),localStorage.setItem("baseUrl",t),console.log(this.baseUrl)}get(t,e){const h=`${this.baseUrl.value}/${t}`;return e?this.http.get(h,{params:e}):this.http.get(h)}post(t,e){return this.http.post(`${this.baseUrl.value}/${t}`,e)}put(t,e){return this.http.put(`${this.baseUrl.value}/${t}`,e)}delete(t){return this.http.delete(`${this.baseUrl.value}/${t}`)}}return(o=v).\u0275fac=function(t){return new(t||o)(r.LFG(c.eN))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),v})()},8409:(D,g,n)=>{n.d(g,{e:()=>c});var l=n(9468),r=n(3959);let c=(()=>{var s;class o{constructor(_){this.baseApiService=_,this.apiUrl="api/Funcionario"}getById(_){return this.baseApiService.get(`${this.apiUrl}/Get/${_}`)}getAllChamados(){return this.baseApiService.get(`${this.apiUrl}/GetAllChamados`)}getAllManutencao(){return this.baseApiService.get(`${this.apiUrl}/GetAllManutencao`)}}return(s=o).\u0275fac=function(_){return new(_||s)(l.LFG(r._))},s.\u0275prov=l.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),o})()},5787:(D,g,n)=>{n.d(g,{U:()=>_});var l=n(5861),r=n(708),c=n(9468),s=n(9843),o=n(3959);let v=(()=>{var t;class e{constructor(p){this.baseApiService=p,this.apiUrl="api/Imobilizado"}getById(p){return this.baseApiService.get(`${this.apiUrl}/GetById/${p}`)}}return(t=e).\u0275fac=function(p){return new(p||t)(c.LFG(o._))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),e})(),_=(()=>{var t;class e{constructor(p,O,b){this.loaddingCtrl=p,this.alertSrv=O,this.imobilizadoSrv=b}get(p){var O=this;return(0,l.Z)(function*(){var b;const A=yield O.loaddingCtrl.create({message:"Aguarde..."});yield A.present();const u=function(L){return(b=b||(0,l.Z)(function*(x){yield A.dismiss(),yield(yield O.alertSrv.create({header:"Erro!",message:x||"Erro desconhecido, tente novamente",buttons:["Ok"]})).present()})).apply(this,arguments)};if(!p)return yield A.dismiss(),null;const P=yield(0,r.n)(O.imobilizadoSrv.getById(p));try{return P&&P.setor?(yield A.dismiss(),P):(u("Imobilizado n\xe3o encontrado"),null)}catch{return u("Erro ao tentar localizar imobilizado, tente novamente"),null}})()}}return(t=e).\u0275fac=function(p){return new(p||t)(c.LFG(s.HT),c.LFG(s.Br),c.LFG(v))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),e})()},8467:(D,g,n)=>{n.d(g,{H:()=>s});var l=n(9862),r=n(9468),c=n(3959);let s=(()=>{var o;class v{constructor(t){this.baseApiService=t,this.patchApi="api/Manutencao"}saveChamado(t){return this.baseApiService.post(`${this.patchApi}/SaveChamado`,t)}saveManutencao(t){return this.baseApiService.post(`${this.patchApi}/SaveManutencao`,t)}getAll(t){let e=new l.LE;if(t&&Object.keys(t)){for(const h in t)t.hasOwnProperty(h)&&(e=e.set(h,t[h]));return this.baseApiService.get(`${this.patchApi}/GetAll`,e)}return this.baseApiService.get(`${this.patchApi}/GetAll`)}cancelamentoChamado(t,e){return this.baseApiService.post(`${this.patchApi}/CancelamentoChamado?id=${t}&obs=${e}`,{})}finalizarManutencao(t){return this.baseApiService.post(`${this.patchApi}/FinalizarManutencao?id=${t}`,{})}finalizarChamado(t){return this.baseApiService.post(`${this.patchApi}/FinalizarChamado?id=${t.id}&funcionarioId=${t.funcionarioId}&setorId=${t.setorId}&obs=${t.obs}`,{})}get(t){return this.baseApiService.get(`${this.patchApi}/Get?id=${t}`)}getAllValidacao(t){return this.baseApiService.get(`${this.patchApi}/GetAllValidacao?mecanicoCod=${t}`)}}return(o=v).\u0275fac=function(t){return new(t||o)(r.LFG(c._))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),v})()},8305:(D,g,n)=>{n.d(g,{G:()=>c});var l=n(9468),r=n(3959);let c=(()=>{var s;class o{constructor(_){this.baseApiService=_,this.apiUrl="api/Setor"}getById(_){return this.baseApiService.get(`${this.apiUrl}/Get/${_}`)}getAllManutecao(){return this.baseApiService.get(`${this.apiUrl}/GetAllManutecao`)}}return(s=o).\u0275fac=function(_){return new(_||s)(l.LFG(r._))},s.\u0275prov=l.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),o})()},708:(D,g,n)=>{n.d(g,{n:()=>r});var l=n(6973);function r(c,s){const o="object"==typeof s;return new Promise((v,_)=>{let e,t=!1;c.subscribe({next:h=>{e=h,t=!0},error:_,complete:()=>{t?v(e):o?v(s.defaultValue):_(new l.K)}})})}}}]);